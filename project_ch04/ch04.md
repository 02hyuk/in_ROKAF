# 챕터 04
@Autowired를 이용한 의존 자동 주입

## 스프링에서의 의존 자동 주입
1. `@Autowired` 어노테이션 사용
2. `@Resource` 어노테이션 사용(javax.annotation.Resource)
3. `@Inject` 어노테이션 사용(javax.inject.Inject)

3개의 어노테이션 중 주로 사용되는 `@Autowired`를 공부할 예정

## @Autowired 어노테이션을 활용해 의존 자동 주입
1. 의존을 주입할 대상(필드)에 어노테이션 적용
    - 그러면 스프링이 설정클래스에서 해당 필드와 일치하는 타입의 빈 객체를 찾아 의존 주입
2. 의존 주입 대상의 세터 메소드에 어노테이션 적용
    - 그러면 스프링이 설정클래스에서 빈을 찾아 세터 메소드의 인자로 전달하여 세터 메소드 호출

## 의존 자동 주입에 문제가 생긴 경우
1. 일치하는 빈이 없는 경우
    - `UnsatisfiedDependencyException` 예외 발생
    - 의존 자동 주입을 적용할 수 있는 빈이 없다는 내용의 에러 메세지를 함께 출력
2. 일치하는 타입의 빈이 두 개 이상
    - `UnsatisfiedDependencyException` 예외 발생
    - 해당 타입의 빈을 한정할 수 없다는 내용의 에러 메세지를 함께 출력

### @Qualifier 어노테이션
자동 주입할 빈을 지정함으로써 2번 문제(같은 타입의 여러 빈)를 해결할 수 있는 수단

#### 사용 위치
1. 빈 설정 메소드(`@Bean` 어노테이션 O)
    - 해당 빈에 **한정자**라는 이름표를 붙여주는 역할
    - 빈 설정에 `@Qualifier` 어노테이션이 없으면 빈의 이름을 한정자로 지정(기본 한정자)
2. 의존 자동 주입 대상(`@Autowired` 어노테이션 O)
    - 속성값과 일치하는 한정자를 가진 빈을 자동 주입 대상으로 선택하겠다는 의미
    - 자동 주입 위치에 `@Qualifier` 어노테이션이 없으면 필드나 파라미터 이름을 한정자로 사용

### 상위/하위 타입 클래스와 자동 주입
설정 클래스에 상위, 하위 클래스의 빈이 모두 존재하는 상황에서<br>
어떤 빈이 상위 클래스의 빈에 의존할 때 자동 주입을 사용한다면 빈 중복 예외가 발생<br>
(하위 클래스는 상위 클래스와 같기 때문)

#### 해결 방법
1. `@Qualifier` 어노테이션 사용
2. 의존 주입 대상을 하위 클래스로 설정

### 의존 자동 주입이 필수가 아닌 경우
`@Autowired`를 이용한 의존 자동 주입은 의존 대상과 일치하는 빈이 없으면 예외를 발생시킴<br>
일치하는 빈이 없어도 프로그램 흐름상 문제가 없는 경우에는 오히려 예외가 발생하면 곤란함

#### 해결 방법
1. 필드나 세터 메소드에 `@Autowired(required = false)`을 대신 적용
    - 일치하는 빈이 없으면 의존 주입 자체를 실행하지 않음
    - 세터 메소드에 `@Autowired` 어노테이션이 적용된 경우 세터 메소드 호출 자체가 X
    - 의존 주입 이전에 필드(의존 주입 대상)에 데이터가 담긴 경우에 적합해 보임
2. 자동 주입 대상으로 T 타입(원하는 타입) 대신 `Optional` 객체 사용
    - 일치하는 빈이 있으면 빈이 담긴 Optional 객체를, 빈이 없으면 값이 없는 `Optional` 객체를 주입
3. 필드, 세터 메소드의 파라미터에 `@Nullable` 어노테이션(org.springframework.lang.Nullable) 사용
    - 일치하는 빈이 없으면 `null`을 주입
    - 세터 메소드에 `@Autowired` 어노테이션이 적용된 경우 `null`을 인자로 전달하여 세터 메소드 호출

### 의존 자동 주입 vs 명시적 의존 주입
- 의존 자동 주입의 우선순위가 더 높음
- 같은 타입의 빈에 대해 의존 자동 주입, 명시적 의존 주입을 동시에 적용한 경우 의존 자동 주입이 적용됨